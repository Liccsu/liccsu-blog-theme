# 系统与插件参数配置指南

本文档介绍主题与 Halo 系统及常用插件的兼容配置。

---

## Halo 后台设置

### 基本设置

> 路径：**后台 → 设置 → 基本设置**

| 配置项 | 说明 |
|--------|------|
| **站点标题** | 主题各处的回退标题 |
| **站点 Logo** | 回退 Logo（导航栏、页脚等） |
| **Favicon** | 浏览器标签图标 |

---

### 文章设置

> 路径：**后台 → 设置 → 文章设置**

| 配置项 | 说明 | 建议值 |
|--------|------|--------|
| **文章列表显示条数** | 首页文章列表每页数量 | 12 |
| **归档页文章显示条数** | 归档页每页数量 | 12 |
| **分类页文章显示条数** | 分类页每页数量 | 12 |
| **标签页文章显示条数** | 标签页每页数量 | 12 |

---

## 图标配置

主题使用 `annotation-setting.yaml` 定义元数据字段，支持可视化图标选择。

### 菜单图标

> 路径：**后台 → 菜单 → 编辑菜单项 → 元数据 → icon**

使用 Iconify 图标选择器选择图标，无需手动填写 SVG 代码。

### 分类/标签图标

> 路径：**后台 → 文章 → 分类管理/标签管理 → 编辑 → 元数据 → icon**

同样使用可视化图标选择器。

---

## 插件参数

### 友链自主提交插件 (plugin-links)

> **建议配置：**
> - ✅ **关闭加载资源**（主题已内置样式）
> - ✅ **开启邮件通知**（及时收到友链申请）

---

### 朋友圈插件 (plugin-friends)

> 路径：**后台 → 插件 → 朋友圈 → 基本设置**

| 配置项 | 来源 | 说明 |
|--------|------|------|
| **页面标题** | 插件设置 | 由插件控制 |
| **列表显示条数** | 插件设置 | 控制每页显示数量 |

---

### 文本绘图插件

| 配置项 | 推荐值 |
|--------|--------|
| **暗黑模式选择器** | `html[data-color-scheme="dark"]` |

---

### lightgallery.js 灯箱插件

请根据以下表格配置灯箱选择器：

| 页面类型 | 路由 | 选择器 |
|----------|------|--------|
| 文章页 | `/archives/**` | `#article-content` |
| 图库首页 | `/photos` | `#photo-grid` |
| 图库详情 | `/photos/**` | `#photo-grid` |
| 瞬间首页 | `/moments` | `.moment-media` |
| 瞬间详情 | `/moments/**` | `.moment-media` |
| 文档页 | `/doc/**` | `#article-content` |

---

### 图库管理插件 (plugin-photos)

| 配置项 | 来源 | 说明 |
|--------|------|------|
| **页面标题** | 主题设置 | 在主题「图库」设置中配置 |
| **列表显示条数** | 插件设置 | 在插件后台设置中控制 |

---

### 瞬间管理插件 (plugin-moments)

| 配置项 | 来源 | 说明 |
|--------|------|------|
| **页面标题** | 主题设置 | 在主题「瞬间」设置中配置 |
| **列表显示条数** | 插件设置 | 在插件后台设置中控制 |

---

## 存储插件兼容性

> 主题的瞬间前端发布功能需要配置存储策略才能上传媒体文件。

### 附件存储策略

> 路径：**后台 → 附件 → 存储策略**

主题前端发布功能通过 `UC 附件 API` 上传文件，不同存储插件的兼容性如下：

| 存储插件 | 图片 | 视频 | 音频 | 兼容性 | 说明 |
|---------|------|------|------|--------|------|
| **本地存储** | ✅ | ✅ | ✅ | 完美兼容 | 推荐生产环境使用 |
| **S3 存储** | ✅ | ✅ | ✅ | 完美兼容 | 支持云存储，推荐 |
| **Lsky 图床** | ✅ | ❌ | ❌ | 部分兼容 | 仅支持图片，有自动压缩 |
| **Alist 存储** | ❌ | ❌ | ❌ | 不兼容 | 已知 bug，等待修复 |

### Alist 不兼容说明

**问题原因**：Halo 2.22.12 核心代码 + Alist 插件组合存在 bug

**技术细节**：
```
Alist 插件创建 Attachment 对象时未初始化 status 字段
    ↓
Halo 核心代码调用 attachment.getStatus().setPermalink()
    ↓
NullPointerException (getStatus() 返回 null)
    ↓
返回 500 错误（但文件实际已上传成功）
```

**状态**：已向 Halo 官方提交问题报告，等待 Alist 插件或 Halo 核心修复

**临时方案**：
- 使用本地存储或 S3 作为默认策略
- 如需图片压缩可使用 Lsky（仅支持图片）

### 配置建议

**推荐配置方案**：

1. **小站点**：使用本地存储
   - 优点：简单、稳定、无需配置
   - 缺点：占用服务器空间

2. **大流量站点**：使用 S3/OSS
   - 优点：CDN 加速、无限容量
   - 缺点：需要配置云服务

3. **图片站点**：使用 Lsky + 本地存储
   - Lsky：处理图片（自动压缩）
   - 本地：处理视频/音频
   - 需配置两个策略
