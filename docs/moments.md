# 瞬间设置 (Moments)

> 路径：**外观 → 主题 → Sky Blog → 设置 → 瞬间**

需安装 `plugin-moments` 插件。

---

## 页面设置

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| **页面标题** | 瞬间页面的标题 | "瞬间" |

---

## 侧边栏设置

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| **显示侧边栏** | 启用后显示侧边栏，页面变为左右布局 | 关闭 |
| **定制侧边栏** | 启用后可单独配置此页面的侧边栏 | 关闭 |
| **侧边栏位置** | 左侧 / 右侧 | 右侧 |
| **小工具列表** | 拖拽排序添加小工具 | - |

### 可用小工具
欢迎卡片（天气）、作者卡片、博客统计、文章分类、标签云、热门文章、最新文章

---

## 交互功能

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| **启用点赞** | 在每条瞬间下方显示点赞按钮 | 开启 |
| **启用评论** | 在每条瞬间下方显示评论区 | 开启 |
| **启用分享** | 在瞬间详情页显示分享按钮 | 开启 |

---

## 前端发布设置

允许登录用户在前端直接发布瞬间（文字 + 媒体）。

### 基本设置

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| **启用前端发布** | 允许登录用户在前端发布瞬间（关闭后隐藏所有发布功能） | 开启 |

### 媒体上传设置

> 需要启用前端发布后才显示

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| **启用图片上传** | 允许用户上传图片 | 开启 |
| **启用视频上传** | 允许用户上传视频 | 开启 |
| **启用音频上传** | 允许用户上传音频 | 开启 |

### 功能特性

- **多媒体支持**：图片（JPG/PNG/GIF/WebP）、视频（MP4/WebM）、音频（MP3/WAV/OGG）
- **批量上传**：支持一次选择多个文件
- **实时预览**：上传后立即显示预览
- **智能布局**：
  - 单图：大图展示（max-h-72）
  - 2/4张：2列网格
  - 其他：3列网格
- **安全防护**：禁止上传可执行文件（HTML/JS/SVG/EXE等）

### 存储插件兼容性

| 存储插件 | 图片 | 视频 | 音频 | 状态 |
|---------|------|------|------|------|
| **本地存储** | ✅ | ✅ | ✅ | 推荐 |
| **S3 存储** | ✅ | ✅ | ✅ | 推荐 |
| **Lsky** | ✅ | ❌ | ❌ | 仅图片 |
| **Alist** | ❌ | ❌ | ❌ | 暂不可用 |

> **Alist 不兼容说明**：
> 
> Halo 2.22.12 + Alist 插件存在已知 bug：
> - Alist 插件创建 Attachment 时未初始化 `status` 字段
> - Halo 核心代码未检查 null 导致 NullPointerException
> - 已提交问题报告，等待修复
> 
> **临时方案**：使用本地存储或 S3

### API 调用

- **上传 API**：`POST /apis/uc.api.storage.halo.run/v1alpha1/attachments/-/upload`
- **发布 API**：`POST /apis/moment.halo.run/v1alpha1/moments`
- **权限要求**：用户需登录且有上传权限

---

## 分享设置

| 设置项 | 说明 |
|--------|------|
| **启用的分享平台** | 选择要启用的分享平台，可拖拽调整顺序 |

### 支持的分享平台
微信、X (Twitter)、Telegram、Facebook、QQ、QQ 空间、微博、豆瓣、系统分享

---

## 悬浮控制栏

| 设置项 | 说明 | 默认值 |
|--------|------|--------|
| **定制悬浮控制栏** | 启用后可单独配置 | 关闭 |
| **Dock 菜单** | 选择菜单 | primary |
| **返回顶部按钮** | 是否显示 | 开启 |
