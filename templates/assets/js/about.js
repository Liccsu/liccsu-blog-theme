!function(t,e){const n={};function o(t,n){if(!t)return n;const o=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(o)return[o[1],o[2],o[3]].map(function(t){return parseInt(t).toString(16).padStart(2,"0")}).join("");try{var a=e.createElement("canvas");a.width=a.height=1;var r=a.getContext("2d");r.fillStyle=t,r.fillRect(0,0,1,1);var i=r.getImageData(0,0,1,1).data;return[i[0],i[1],i[2]].map(function(t){return t.toString(16).padStart(2,"0")}).join("")}catch(l){return console.log("[GitHub] colorToHex error:",l),n}}n.initScrollReveal=function(){const t=e.querySelectorAll("[data-reveal]");if(!t.length)return;const n=new IntersectionObserver(function(t){t.forEach(function(t){t.isIntersecting&&t.target.classList.add("revealed")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"});t.forEach(function(t){n.observe(t)})},n.initStatCounter=function(){const t=e.querySelectorAll("[data-stat-value]");if(!t.length)return;const o=new IntersectionObserver(function(t){t.forEach(function(t){t.isIntersecting&&!t.target.classList.contains("counted")&&(t.target.classList.add("counted"),n.animateNumber(t.target))})},{threshold:.3,rootMargin:"0px 0px -20px 0px"});t.forEach(function(t){o.observe(t)})},n.easeOutQuart=function(t){return 1-Math.pow(1-t,4)},n.animateNumber=function(t){const e=parseInt(t.getAttribute("data-target"))||0,o=t.querySelector(".sf-stat-number");if(!o)return;const a=performance.now();function r(t){return t>=1e4?t.toLocaleString("zh-CN"):t.toString()}requestAnimationFrame(function t(i){const l=i-a,s=Math.min(l/1800,1),c=n.easeOutQuart(s),u=Math.floor(c*e);o.textContent=r(u),s<1?requestAnimationFrame(t):o.textContent=r(e)})},n.initArticleHeatmap=function(){const n=e.getElementById("article-heatmap-container");if(!n||!t.aboutPagePosts)return;const o=t.aboutPagePosts.filter(function(t){return t.title&&t.date});if(!o.length)return;const a=n.querySelector(".heatmap-canvas"),r=e.getElementById("article-count");r&&(r.textContent=o.length);const i={};o.forEach(function(t){const e=new Date(t.date),n=e.getFullYear()+"-"+String(e.getMonth()+1).padStart(2,"0")+"-"+String(e.getDate()).padStart(2,"0");i[n]||(i[n]=[]),i[n].push(t)});const l=new Date,s=new Date(l);s.setDate(s.getDate()-364);const c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u=[];let g=-1;for(let t=0;t<53;t++){const e=new Date(s);e.setDate(e.getDate()+7*t);const n=e.getMonth();n!==g&&(u.push('<text x="'+(25+14*t)+'" y="10" class="heatmap-month-label">'+c[n]+"</text>"),g=n)}const h=["","Mon","","Wed","","Fri",""],d=[1,3,5].map(function(t){return'<text x="0" y="'+(15+14*t+8.25)+'" class="heatmap-label">'+h[t]+"</text>"}),m=[],p=Math.max.apply(null,Object.values(i).map(function(t){return t.length}).concat([1]));for(let t=0;t<371;t++){const e=Math.floor(t/7),n=t%7,o=new Date(s);if(o.setDate(o.getDate()+7*e+n),o>l)continue;const a=o.getFullYear()+"-"+String(o.getMonth()+1).padStart(2,"0")+"-"+String(o.getDate()).padStart(2,"0"),r=i[a]?i[a].length:0,c=0===r?0:Math.ceil(r/p*3);let u;u=0===c?"color-mix(in oklch, var(--color-base-content) 15%, var(--color-base-100))":1===c?"color-mix(in oklch, var(--color-primary) 40%, var(--color-base-100))":2===c?"color-mix(in oklch, var(--color-primary) 70%, var(--color-base-100))":"var(--color-primary)",m.push('<rect x="'+(25+14*e)+'" y="'+(15+14*n)+'" width="'+'11" height="'+'11" rx="2" fill="'+u+'" class="article-heatmap-cell heatmap-cell-animated" style="animation-delay:'+t+'ms" data-date="'+a+'" data-count="'+r+'"></rect>')}a.innerHTML='<svg class="article-heatmap-svg" viewBox="0 0 770 116"><g>'+u.join("")+"</g><g>"+d.join("")+"</g><g>"+m.join("")+"</g></svg>";const f=e.getElementById("article-tooltip");a.querySelectorAll(".article-heatmap-cell").forEach(function(e){e.addEventListener("mouseenter",function(n){if(!f)return;const a=e.getAttribute("data-date"),r=e.getAttribute("data-count"),i=new Date(a),l=i.getFullYear()+"/"+(i.getMonth()+1)+"/"+i.getDate(),s=o.filter(function(t){return new Date(t.date).toDateString()===i.toDateString()});let c='<div class="heatmap-tooltip-date">'+l+'</div><div class="heatmap-tooltip-count">'+r+" 篇文章</div>";s.length>0&&(c+='<div class="heatmap-tooltip-posts">',s.slice(0,3).forEach(function(t){c+='<span class="heatmap-tooltip-post">'+t.title+"</span>"}),s.length>3&&(c+='<span class="heatmap-tooltip-post">+'+(s.length-3)+" 更多...</span>"),c+="</div>"),f.innerHTML=c,f.style.display="block";var u=f.offsetWidth||200,g=f.offsetHeight||100,h=t.innerWidth,d=t.innerHeight,m=t.scrollX||t.pageXOffset,p=t.scrollY||t.pageYOffset,b=n.pageX+10,y=n.pageY+10;b+u>m+h-20&&(b=n.pageX-u-10),y+g>p+d-20&&(y=n.pageY-g-10),b<m+10&&(b=m+10),f.style.left=b+"px",f.style.top=y+"px"}),e.addEventListener("mouseleave",function(){f&&(f.style.display="none")})})},n.updateGitHubColors=function(){const n=t.aboutGithubConfig;if(!n||!n.username)return;var a=n.theme?String(n.theme).trim():"";if(a&&"null"!==a&&"undefined"!==a)return;const r=e.getElementById("about-color-probe");let i="1f2937",l="6b7280";r&&(i=o(getComputedStyle(r).backgroundColor,i),l=o(getComputedStyle(r).color,l));var s=n.locale?String(n.locale).trim():"",c=s&&"null"!==s&&"undefined"!==s?"&locale="+s:"";const u=e.querySelector(".github-heatmap-img");u&&(u.src="https://ghchart.rshah.org/"+i+"/"+n.username);const g=e.getElementById("github-stats-img");g&&(g.src=n.statsHost+"/api?username="+n.username+"&show_icons=true&hide_border=true"+c+"&theme=transparent&title_color="+i+"&icon_color="+i+"&text_color="+l+"&bg_color=00000000");const h=e.getElementById("github-langs-img");h&&(h.src=n.statsHost+"/api/top-langs/?username="+n.username+"&layout=compact&hide_border=true"+c+"&theme=transparent&title_color="+i+"&text_color="+l+"&bg_color=00000000")},n.initGitHub=function(){const a=e.getElementById("github-heatmap-container"),r=t.aboutGithubConfig;if(!r||!r.username)return;const i=e.getElementById("about-color-probe");let l="1f2937",s="6b7280";if(i&&(l=o(getComputedStyle(i).backgroundColor,l),s=o(getComputedStyle(i).color,s)),a){const t=a.querySelector(".github-heatmap-img"),e=a.querySelector(".sf-loading");t&&(t.onload=function(){t.style.display="block",e&&(e.style.display="none")},t.onerror=function(){e&&(e.innerHTML='<span style="opacity:0.6;">加载失败</span>')},t.src="https://ghchart.rshah.org/"+l+"/"+r.username)}var c=r.locale?String(r.locale).trim():"",u=c&&"null"!==c&&"undefined"!==c?"&locale="+c:"",g=r.theme?String(r.theme).trim():"",h=g&&"null"!==g&&"undefined"!==g;const d=e.getElementById("github-stats-img"),m=e.getElementById("github-langs-img");if(d){var p=r.statsHost+"/api?username="+r.username+"&show_icons=true&hide_border=true"+u;p+=h?"&theme="+g:"&theme=transparent&title_color="+l+"&icon_color="+l+"&text_color="+s+"&bg_color=00000000",d.src=p}if(m){var f=r.statsHost+"/api/top-langs/?username="+r.username+"&layout=compact&hide_border=true"+u;f+=h?"&theme="+g:"&theme=transparent&title_color="+l+"&text_color="+s+"&bg_color=00000000",m.src=f}new MutationObserver(function(t){t.forEach(function(t){"data-theme"!==t.attributeName&&"data-color-scheme"!==t.attributeName||requestAnimationFrame(function(){n.updateGitHubColors()})})}).observe(e.documentElement,{attributes:!0,attributeFilter:["data-theme","data-color-scheme"]})},n.initLocation=function(){const t=e.getElementById("location-map");if(!t)return;const n=parseFloat(t.getAttribute("data-lat")),o=parseFloat(t.getAttribute("data-lng")),a=t.getAttribute("data-name")||"位置";if(isNaN(n)||isNaN(o))return void(t.innerHTML='<div style="display:flex;align-items:center;justify-content:center;height:100%;opacity:0.5;">请配置位置坐标</div>');const r="https://apis.map.qq.com/ws/staticmap/v2/?center="+n+","+o+"&zoom=13&size="+Math.min(800,t.offsetWidth||800)+"*320&markers=color:red|label:A|"+n+","+o+"&key=OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77",i="https://uri.amap.com/marker?position="+o+","+n+"&name="+encodeURIComponent(a)+"&coordinate=gaode&callnative=1";t.innerHTML='<a href="'+i+'" target="_blank" rel="noopener" style="display:block;position:relative;width:100%;height:100%;min-height:320px;border-radius:0.75rem;overflow:hidden;cursor:pointer;transition:all 0.3s ease;"><img src="'+r+'" alt="地图位置" style="width:100%;height:100%;object-fit:cover;" loading="lazy" /><div style="position:absolute;bottom:1rem;right:1rem;display:inline-flex;align-items:center;gap:0.5rem;padding:0.5rem 1rem;background:var(--color-base-content);color:var(--color-base-100);border-radius:2rem;font-size:0.875rem;font-weight:600;box-shadow:0 4px 12px rgba(0,0,0,0.25);"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>在地图中查看</div></a>'},n.initToolkitProgress=function(){const t=e.querySelectorAll(".sf-tool-progress");if(!t.length)return;const n=new IntersectionObserver(function(t){t.forEach(function(t){if(t.isIntersecting&&!t.target.classList.contains("animated")){t.target.classList.add("animated");const e=t.target.style.width;t.target.style.width="0",setTimeout(function(){t.target.style.width=e},100)}})},{threshold:.5});t.forEach(function(t){n.observe(t)})},n.initSmoothScroll=function(){e.querySelectorAll('a[href^="#"]').forEach(function(t){t.addEventListener("click",function(t){const n=this.getAttribute("href");if("#"===n)return;const o=e.querySelector(n);o&&(t.preventDefault(),o.scrollIntoView({behavior:"smooth",block:"start"}))})})},e.addEventListener("DOMContentLoaded",function(){n.initScrollReveal(),n.initStatCounter(),n.initArticleHeatmap(),n.initGitHub(),n.initToolkitProgress(),n.initSmoothScroll(),setTimeout(n.initLocation,500)})}(window,document);
