(function(){const w="sky_weather_cache_v12",x={sunBody:`<svg viewBox="0 0 200 200" class="w-full h-full fill-current text-yellow-400">
                <circle cx="100" cy="100" r="60" />
                <g class="sun-face" fill="#cc9900">
                  <circle cx="75" cy="90" r="8" />
                  <circle cx="125" cy="90" r="8" />
                  <path d="M70 120 Q100 145 130 120" stroke="#cc9900" stroke-width="6" fill="none" stroke-linecap="round" />
                  <ellipse cx="60" cy="105" rx="6" ry="3" fill="#ff7e7e" opacity="0.6" />
                  <ellipse cx="140" cy="105" rx="6" ry="3" fill="#ff7e7e" opacity="0.6" />
                </g>
              </svg>`,sunRays:`<svg viewBox="0 0 200 200" class="w-full h-full stroke-current text-yellow-400">
                <g stroke-width="12" stroke-linecap="round">
                  <path d="M100 20 L100 0 M100 180 L100 200 M20 100 L0 100 M180 100 L200 100 M43 43 L29 29 M157 157 L171 171 M43 157 L29 171 M157 43 L171 29" />
                </g>
              </svg>`,moon:`<svg viewBox="0 0 200 200" class="w-full h-full fill-current text-yellow-100">
             <path d="M100 15 A 85 85 0 1 1 100 185 A 65 65 0 1 0 100 15 Z" />
             <circle cx="80" cy="80" r="12" fill="rgba(0,0,0,0.1)" />
             <circle cx="120" cy="120" r="8" fill="rgba(0,0,0,0.1)" />
             <circle cx="90" cy="140" r="5" fill="rgba(0,0,0,0.1)" />
           </svg>`,cloud:`<svg viewBox="0 0 25 25" class="w-full h-full fill-current">
              <path d="M19.5,10 C19.5,6.96 17.04,4.5 14,4.5 C11.6,4.5 9.55,6.03 8.8,8.2 C8.54,8.13 8.27,8.1 8,8.1 C5.24,8.1 3,10.34 3,13.1 C3,15.86 5.24,18.1 8,18.1 L19.5,18.1 C21.98,18.1 24,16.08 24,14 C24,11.92 21.98,10 19.5,10 Z" />
            </svg>`};let p={type:"sunny",temp:20},v=null,m=null,k=!0,R=!1,I=null;function Z(e){return e==="rain"?"rainy":e==="snow"?"snowy":e==="fog"?"foggy":e}function S(){if(v=document.getElementById("weather-effect-root"),!v||(m=v.querySelector(".weather-effect-layer"),!m))return;K(),Q();const e=setTimeout(()=>{R||(B(),k=!1)},3e3);window.addEventListener("sky-weather-updated",t=>{const n=t.detail?.weatherBg;if(!n)return;const a=Z(n);k?(clearTimeout(e),R=!0,a!==p.type&&(p.type=a,A()),B(),k=!1):a!==p.type&&(p.type=a,A())}),le(),J()}function B(){window.dispatchEvent(new CustomEvent("sky-weather-effect-ready"))}function J(){I&&clearInterval(I),I=setInterval(()=>{window.dispatchEvent(new CustomEvent("sky-weather-refresh-request"))},18e5)}function A(){if(!m)return;const e=m,t=document.createElement("div");t.className="weather-effect-layer",t.style.cssText="position: absolute; inset: 0; opacity: 0; transition: opacity 400ms ease-in-out;",e.parentNode.insertBefore(t,e.nextSibling),m=t,z();const n=v.querySelector(".weather-effect");n&&(n.className="weather-effect weather-"+p.type,n.style.setProperty("--wind-force",1)),requestAnimationFrame(()=>{t.style.opacity="1",e.style.transition="opacity 400ms ease-in-out",e.style.opacity="0"}),setTimeout(()=>{_(e),e.parentNode&&e.parentNode.removeChild(e),t.style.cssText=""},450)}function _(e){if(!e)return;e.querySelectorAll("[data-has-cleanup]").forEach(n=>{typeof n._cleanup=="function"&&n._cleanup()}),Array.from(e.children).forEach(n=>{typeof n._cleanup=="function"&&n._cleanup()})}function K(){try{const t=localStorage.getItem(w);if(t){const n=JSON.parse(t),a=n.weatherBg;if(a){let r=a;a==="rain"&&(r="rainy"),a==="snow"&&(r="snowy"),a==="fog"&&(r="foggy"),p.type=r,p.temp=parseFloat(n.weather?.temp||20);return}}}catch{}const e=new Date().getHours();p.type=e>=18||e<6?"night-clear":"sunny"}function Q(){if(!m)return;_(m),m.innerHTML="";const e=v.querySelector(".weather-effect");e&&(e.className="weather-effect weather-"+p.type,e.style.setProperty("--wind-force",1)),z()}function z(){switch(j(),p.type){case"sunny":H();break;case"cloudy":D(!1);break;case"night-clear":te();break;case"night-cloudy":D(!0);break;case"foggy":ne();break;case"rainy":ae();break;case"snowy":ie();break;case"stormy":se();break}const e=document.createElement("div");e.className="bottom-fade",m.appendChild(e)}function j(){const e=document.createElement("div");e.className="atmosphere-glow",m.appendChild(e)}function H(){const e=document.createElement("div");e.className="sunny-scene-container";const t=document.createElement("div");t.className="sunny-lawn",e.appendChild(t);for(let s=0;s<40;s++){const i=document.createElement("div");i.className="sunny-grass-blade",i.style.left=`${Math.random()*100}%`,i.style.height=`${15+Math.random()*25}px`,i.style.animationDelay=`${-Math.random()*4}s`,t.appendChild(i)}const n=["flower-type-tulip","flower-type-daisy","flower-type-sunflower"];for(let s=0;s<12;s++){const i=document.createElement("div"),l=n[Math.floor(Math.random()*n.length)];i.className=`sunny-flower-detailed ${l}`;const c=document.createElement("div");c.className="flower-head",i.appendChild(c),i.style.left=`${5+Math.random()*90}%`,i.style.height=`${40+Math.random()*40}px`,i.style.animationDelay=`${-Math.random()*5}s`,i.style.transform=`scale(${.7+Math.random()*.5})`,t.appendChild(i)}m.appendChild(e);const a=document.createElement("div");a.className="sun-container";const r=document.createElement("div");r.className="sun-rays",r.innerHTML=x.sunRays,a.appendChild(r);const d=document.createElement("div");d.className="sun-body",d.innerHTML=x.sunBody,a.appendChild(d);const o=document.createElement("div");o.className="sun-glow-outer",a.appendChild(o),m.appendChild(a);for(let s=0;s<15;s++)ee()}function ee(){const e=document.createElement("div");e.className="bokeh-particle";const t=20+Math.random()*60;e.style.cssText=`
      width: ${t}px; height: ${t}px;
      left: ${Math.random()*100}%; top: ${Math.random()*80}%;
      opacity: ${.1+Math.random()*.2};
      animation-duration: ${15+Math.random()*20}s;
      animation-delay: ${-Math.random()*20}s;
    `,m.appendChild(e)}function D(e){e?(O(),q(30,!0),F(!0)):H();const t=e?5:8;for(let n=0;n<t;n++)W(e)}function W(e,t){const n=document.createElement("div");n.className="cloud-cartoon "+(e?"night":"day"),n.innerHTML=x.cloud;const a=.6+Math.random()*1.2,r=5+Math.random()*50,d=60+(1.8-a)*40+Math.random()*30,o=e?.3+Math.random()*.2:.85+Math.random()*.15,s=Math.random()*300;n.style.cssText=`
      top: ${r}%;
      left: 0;
      --cloud-scale: ${a};
      --cloud-start-offset: ${s}px;
      opacity: ${o};
      animation-duration: ${d}s;
      animation-delay: ${-Math.random()*d}s;
      z-index: ${20+Math.floor(a*10)};
      color: ${e?"#a0a4b8":"#ffffff"};
    `,m.appendChild(n)}function te(){O(),q(50,!0),F(!1)}function O(){const e=document.createElement("div");e.className="night-scene-container",e.id="night-scene",["sm-1","sm-2"].forEach(o=>{const s=document.createElement("div");s.className=`spooky-mountain ${o}`,e.appendChild(s)});for(let o=0;o<6;o++){const s=document.createElement("div");s.className="spooky-tree";const i=180+Math.random()*100,l=i*.6;s.style.cssText=`
            left: ${-10+Math.random()*110}%; // 覆盖稍宽范围
            width: ${l}px;
            height: ${i}px;
            z-index: ${2+Math.random()*2};
            transform: scaleX(${Math.random()>.5?1:-1}); // 随机翻转
        `,e.appendChild(s)}m.appendChild(e);const a=setInterval(()=>{if(!document.getElementById("night-scene"))return;const o=document.createElement("div"),s=Math.random()>.7;o.className=`spooky-eye-pair ${s?"eyes-yellow":""}`,o.style.left=`${Math.random()*100}%`,o.style.bottom=`${20+Math.random()*100}px`,o.style.animationDelay=`${Math.random()*2}s`,e.appendChild(o),setTimeout(()=>o.remove(),4e3)},2e3),d=setInterval(()=>{if(!document.getElementById("night-scene"))return;const o=document.createElement("div");o.className="ghost-firefly",o.style.left=`${Math.random()*100}%`,o.style.bottom=`${Math.random()*50}%`,e.appendChild(o),setTimeout(()=>o.remove(),8e3)},1500);e._cleanup=()=>{clearInterval(a),clearInterval(d)}}function F(e){const t=document.createElement("div");t.className="moon-container",e&&t.classList.add("cloudy-moon");const n=document.createElement("div");n.className="moon-icon",n.innerHTML=x.moon,t.appendChild(n);const a=document.createElement("div");a.className="moon-glow",t.appendChild(a),m.appendChild(t)}function q(e,t=!1){for(let n=0;n<e;n++){const a=document.createElement("div");a.className="star",t&&a.classList.add("dim");const r=1+Math.random()*3;a.style.cssText=`
        width: ${r}px; height: ${r}px;
        left: ${Math.random()*100}%; top: ${Math.random()*60}%;
        animation-duration: ${2+Math.random()*3}s;
        animation-delay: ${-Math.random()*3}s;
      `,m.appendChild(a)}}function ne(){const e=document.createElement("div");e.className="mist-scene-container",e.id="mist-scene";const t=document.createElement("div");t.className="mist-sun",e.appendChild(t),["m-1","m-2","m-3"].forEach(l=>{const c=document.createElement("div");c.className=`mist-mountain ${l}`,e.appendChild(c)}),["t-1","t-2","t-3","t-4"].forEach(l=>{const c=document.createElement("div");c.className=`mist-tree ${l}`,e.appendChild(c)});const r=["mist-layer-2","mist-layer-1","mist-layer-3"],d=[];r.forEach(l=>{const c=document.createElement("div");c.className=`mist-fog-layer ${l}`,e.appendChild(c),d.push(c)}),m.appendChild(e);const s=setInterval(()=>{if(!document.getElementById("mist-scene"))return;const l=document.createElement("div");l.className="mist-fog-puff";const c=Math.random()*180+60,f=Math.random()*35+55,y=Math.random()*10+12,C=(Math.random()-.5)*400;l.style.cssText=`
        width: ${c}px; height: ${c}px;
        top: ${f}%; left: ${Math.random()*100}%;
      `;const M=l.animate([{transform:"translate(0, 0) scale(0.5)",opacity:0},{opacity:.5,offset:.2},{opacity:.5,offset:.8},{transform:`translate(${C}px, -80px) scale(1.8)`,opacity:0}],{duration:y*1e3,easing:"linear",fill:"forwards"});e.appendChild(l),M.onfinish=()=>l.remove()},600),i=l=>{const c=l.clientX/window.innerWidth;d[1]&&(d[1].style.transform=`translateX(${-c*50}px)`),d[0]&&(d[0].style.transform=`translateX(${c*20}px) scaleX(-1)`),d[2]&&(d[2].style.transform=`translateX(${-c*90}px)`)};document.addEventListener("mousemove",i),e._cleanup=()=>{clearInterval(s),document.removeEventListener("mousemove",i)}}function ae(){P(!1)}function se(){P(!0)}function P(e){for(let h=0;h<(e?8:5);h++)W(!0);const t=window.innerWidth,n=e?t/10:t/25,a=Math.min(e?150:60,Math.max(20,Math.floor(n))),r=e?{count:a,speedBase:14,wind:-6,thickness:3,color:"rgba(130, 180, 255, 0.8)"}:{count:a,speedBase:8,wind:-2,thickness:2,color:"rgba(174, 217, 255, 0.6)"},d=document.createElement("canvas");d.className="rain-canvas",d.id="rain-canvas",m.appendChild(d);const o=document.createElement("canvas");o.className="lightning-canvas",o.id="lightning-canvas",m.appendChild(o);const s=document.createElement("div");s.className="flash-overlay",s.id="flash-overlay",m.appendChild(s);const i=document.createElement("div");i.className="rain-ground-props",oe(i),m.appendChild(i);const l=d.getContext("2d"),c=o.getContext("2d");let f,y,C=[],M=[],X=null,b=0;function G(){f=d.width=o.width=m.offsetWidth||window.innerWidth,y=d.height=o.height=m.offsetHeight||window.innerHeight,C.forEach(h=>{h.x>f&&(h.x=Math.random()*f)})}G();let U;const Y=()=>{clearTimeout(U),U=setTimeout(()=>{G()},200)};window.addEventListener("resize",Y);class ce{constructor(u=!1){this.x=Math.random()*f,this.y=u?Math.random()*y:-50,this.z=Math.random(),this.speed=r.speedBase*(1+this.z)+Math.random()*2,this.len=10+this.z*15,this.thick=r.thickness*(.5+this.z*.5),this.vx=r.wind*(1+(1-this.z))}update(){this.x+=this.vx,this.y+=this.speed,this.y>y-40&&(Math.random()>.85&&M.push(new re(this.x,y-40)),this.reset()),this.x<0&&(this.x=f),this.x>f&&(this.x=0)}reset(){this.x=Math.random()*f,this.y=-50,this.z=Math.random(),this.speed=r.speedBase*(1+this.z)+Math.random()*2}draw(){l.beginPath(),l.moveTo(this.x,this.y),l.lineTo(this.x-this.vx*2,this.y-this.len),l.strokeStyle=r.color,l.lineWidth=this.thick,l.lineCap="round",l.stroke()}}class re{constructor(u,g){this.x=u,this.y=g,this.life=8,this.particles=[];for(let $=0;$<3;$++)this.particles.push({vx:(Math.random()-.5)*4,vy:-Math.random()*3,px:0,py:0})}update(){this.life--,this.particles.forEach(u=>{u.px+=u.vx,u.py+=u.vy,u.vy+=.3})}draw(){const u=this.life/8;l.fillStyle=`rgba(200, 230, 255, ${u})`,this.particles.forEach(g=>{l.beginPath(),l.arc(this.x+g.px,this.y+g.py,2,0,Math.PI*2),l.fill()})}}for(let h=0;h<r.count;h++)C.push(new ce(!0));function de(){c.clearRect(0,0,f,y),c.beginPath();let u=f*.2+Math.random()*f*.6,g=0;for(c.moveTo(u,g);g<y*.7;){const $=(Math.random()-.5)*80,he=20+Math.random()*40;u+=$,g+=he,c.lineTo(u,g)}c.strokeStyle="#fff",c.shadowBlur=25,c.shadowColor="#f1c40f",c.lineWidth=3,c.stroke(),c.shadowBlur=0,setTimeout(()=>c.clearRect(0,0,f,y),120)}function me(){s.style.opacity="0.7",setTimeout(()=>{s.style.opacity="0"},80),setTimeout(()=>{s.style.opacity="0.3"},120),setTimeout(()=>{s.style.opacity="0"},200),v.classList.add("weather-shake"),setTimeout(()=>v.classList.remove("weather-shake"),400),de()}function V(){if(document.getElementById("rain-canvas")){l.clearRect(0,0,f,y),C.forEach(h=>{h.update(),h.draw()});for(let h=M.length-1;h>=0;h--)M[h].update(),M[h].draw(),M[h].life<=0&&M.splice(h,1);if(e){const h=Date.now();h>b&&(me(),b=h+2500+Math.random()*4e3)}X=requestAnimationFrame(V)}}b=Date.now()+1e3,V();const N=document.createElement("div");N.id="rain-system",N.style.display="none",N._cleanup=()=>{cancelAnimationFrame(X),window.removeEventListener("resize",Y)},m.appendChild(N)}function oe(e){const t=document.createElement("div");t.className="rain-meadow-container",["rm-hill-2","rm-hill-1","rm-hill-3"].forEach(o=>{const s=document.createElement("div");s.className=`rain-meadow-hill ${o}`,t.appendChild(s)}),e.appendChild(t);const n=document.createElement("div");n.className="rain-puddle",n.style.cssText="width: 80px; height: 25px; left: 25%; bottom: 15px;",e.appendChild(n);const a=document.createElement("div");a.className="flat-rain-path",e.appendChild(a);const r=document.createElement("div");r.className="flat-rain-house",r.innerHTML=`
          <div class="house-chimney"></div>
          <div class="house-window"></div>
      `,e.appendChild(r);const d=document.createElement("div");d.className="flat-rain-lamp",d.innerHTML=`
          <div class="lamp-head"></div>
          <div class="lamp-light"></div> 
      `,e.appendChild(d)}function ie(){const e=document.createElement("div");e.className="snow-scene-container",["sh-1","sh-2"].forEach(s=>{const i=document.createElement("div");i.className=`snow-hill ${s}`,e.appendChild(i)});const n=document.createElement("div");n.className="snow-ground",e.appendChild(n);const a=document.createElement("div");a.className="snow-igloo";const r=document.createElement("div");r.className="snow-igloo-entrance",a.appendChild(r),e.appendChild(a),["sp-1","sp-2","sp-3"].forEach(s=>{const i=document.createElement("div");i.className=`snow-pine ${s}`,e.appendChild(i)}),m.appendChild(e);const o=document.createElement("div");o.className="snow-container";for(let s=0;s<80;s++){const i=document.createElement("div");i.className="snow-flake-svg";const l=Math.random()<.3,c=l?12+Math.random()*10:4+Math.random()*8,f=l?6+Math.random()*4:3+Math.random()*5;Math.random()>.4?i.innerHTML='<svg viewBox="0 0 24 24" class="w-full h-full fill-current"><circle cx="12" cy="12" r="8"/></svg>':i.innerHTML='<svg viewBox="0 0 24 24" class="w-full h-full stroke-current" stroke-width="2"><path d="M12 2v20M2 12h20M4.93 4.93l14.14 14.14M4.93 19.07L19.07 4.93"/></svg>';const y=20;i.style.cssText=`
        left: ${Math.random()*100}%;
        width: ${c}px; height: ${c}px;
        opacity: ${l?.95:.6+Math.random()*.3};
        --wind-offset: ${y}px;
        animation-duration: ${f}s;
        animation-delay: ${-Math.random()*f}s;
      `,o.appendChild(i)}m.appendChild(o)}function le(){const e=v.querySelector(".scroll-mask");if(!e)return;let t=!1;window.addEventListener("scroll",()=>{t||(requestAnimationFrame(()=>{e.style.opacity=window.scrollY>50?"0.3":"0",t=!1}),t=!0)},{passive:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{S()}):S()})();window.handleMomentCardGlow=function(w,E){const T=E.querySelector(".moment-glow");if(!T)return;const L=E.getBoundingClientRect(),x=w.clientX-L.left,p=w.clientY-L.top;T.style.left=x+"px",T.style.top=p+"px"};window.showMomentCardGlow=function(w){const E=w.querySelector(".moment-glow");E&&(E.style.opacity="1")};window.hideMomentCardGlow=function(w){const E=w.querySelector(".moment-glow");E&&(E.style.opacity="0")};(function(){const w={titleElement:null,decorationEffect:"none",styleEffect:"none",originalText:"",init(){this.titleElement=document.getElementById("main-title"),this.titleElement&&(this.decorationEffect=this.titleElement.dataset.decorationEffect||"none",this.styleEffect=this.titleElement.dataset.styleEffect||"none",this.originalText=this.titleElement.dataset.originalText||this.titleElement.textContent.trim(),this.applyEffects())},applyEffects(){this.applyDecorationEffect(),this.applyStyleEffect()},applyDecorationEffect(){this.decorationEffect!=="none"&&((this.decorationEffect==="effect-particles"||this.decorationEffect==="effect-starlight")&&(this.titleElement.innerHTML=`<span><span><span>${this.originalText}</span></span></span>`),this.titleElement.classList.add(this.decorationEffect),this.decorationEffect==="effect-neon-edge"&&this.titleElement.setAttribute("data-text",this.originalText))},applyStyleEffect(){this.styleEffect!=="none"&&(this.titleElement.classList.add(this.styleEffect),(this.styleEffect==="effect-marker-pop"||this.styleEffect==="effect-diagonal-split")&&this.titleElement.setAttribute("data-text",this.originalText))}};document.addEventListener("DOMContentLoaded",()=>{w.init()})})();
