window.handleMomentUpvote=async function(e){const t=e.dataset.momentName;if(!t)return;const o=JSON.parse(localStorage.getItem("halo.upvoted.moment.names")||"[]");if(!o.includes(t))try{if((await fetch("/apis/api.halo.run/v1alpha1/trackers/upvote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({group:"moment.halo.run",plural:"moments",name:t})})).ok){const a=e.querySelector(".upvote-count"),n=parseInt(a.textContent)||0;a.textContent=n+1;const s=e.querySelector('span[class*="icon"]');s&&(s.className=s.className.replace("icon-[heroicons--heart]","icon-[heroicons--heart-solid]"),e.classList.add("text-error"),e.classList.remove("text-base-content/50")),o.push(t),localStorage.setItem("halo.upvoted.moment.names",JSON.stringify(o))}}catch(a){console.error("点赞失败:",a)}},document.addEventListener("DOMContentLoaded",function(){const e=JSON.parse(localStorage.getItem("halo.upvoted.moment.names")||"[]");document.querySelectorAll("[data-moment-name]").forEach(function(t){const o=t.dataset.momentName;if(e.includes(o)){const e=t.querySelector('span[class*="icon"]');e&&(e.className=e.className.replace("icon-[heroicons--heart]","icon-[heroicons--heart-solid]"),t.classList.add("text-error"),t.classList.remove("text-base-content/50"))}})});
