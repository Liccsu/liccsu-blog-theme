<!doctype html>
<html xmlns:th="https://www.thymeleaf.org">
  <!-- ========================================== -->
  <!--           文章页头部 Banner - 苹果风        -->
  <!-- ========================================== -->

  <header
    th:fragment="banner"
    class="post-banner relative w-full"
    th:with="headerBgSettings=${theme.config.article.header_background},
           fallbackImage=${headerBgSettings.enable_fallback != false and headerBgSettings.fallback_image != null and !headerBgSettings.fallback_image.isEmpty() ? headerBgSettings.fallback_image : ''},
           primaryImage=${headerBgSettings.background_type == 'cover' ? post.spec.cover : headerBgSettings.custom_image},
           hasPrimaryImage=${primaryImage != null and !primaryImage.isEmpty()},
           finalImage=${hasPrimaryImage ? primaryImage : fallbackImage}"
  >
    <!-- 背景图片区域 -->
    <div class="relative h-[50vh] max-h-[450px] min-h-[320px] overflow-hidden">
      <!-- 背景图片 -->
      <div class="absolute inset-0">
        <img
          th:if="${finalImage != null and !finalImage.isEmpty()}"
          class="h-full w-full object-cover object-center"
          th:src="${finalImage}"
          alt="文章背景图"
        />

        <!-- 无图片时的渐变背景 -->
        <div
          th:unless="${finalImage != null and !finalImage.isEmpty()}"
          class="from-primary/90 via-primary/70 to-secondary/90 h-full w-full bg-gradient-to-br"
        ></div>
      </div>

      <!-- 渐变蒙版 - 底部融合 -->
      <div class="from-base-100 via-base-100/50 absolute inset-0 bg-gradient-to-t to-transparent"></div>

      <!-- 内容定位在底部 -->
      <div class="absolute inset-x-0 bottom-0">
        <div class="mx-auto max-w-7xl px-4">
          <div class="max-w-4xl lg:w-3/4 lg:max-w-none lg:pr-8">
            <!-- 分类 + 标签 - 使用 DaisyUI badge -->
            <div class="mb-4 flex flex-wrap items-center gap-2">
              <!-- 分类 -->
              <th:block th:if="${post.categories != null and !#lists.isEmpty(post.categories)}">
                <a
                  th:each="category : ${post.categories}"
                  th:href="@{${category.status.permalink}}"
                  th:with="categoryIcon = ${category.metadata.annotations?.get('icon')}"
                  class="badge badge-primary badge-sm cursor-pointer gap-1 transition-opacity hover:opacity-80"
                >
                  <th:block th:if="${categoryIcon != null and !categoryIcon.isEmpty()}">
                    <span th:utext="${categoryIcon}" class="h-3 w-3 [&>svg]:h-3 [&>svg]:w-3"></span>
                  </th:block>
                  <span th:text="${category.spec.displayName}"></span>
                </a>
              </th:block>

              <!-- 标签 -->
              <th:block th:if="${post.tags != null and !#lists.isEmpty(post.tags)}">
                <a
                  th:each="tag : ${post.tags}"
                  th:href="@{${tag.status.permalink}}"
                  th:with="tagIcon = ${tag.metadata.annotations?.get('icon')}"
                  class="badge badge-sm bg-base-content/10 hover:bg-base-content/20 cursor-pointer gap-1 border-0 transition-colors"
                >
                  <th:block th:if="${tagIcon != null and !tagIcon.isEmpty()}">
                    <span th:utext="${tagIcon}" class="h-3 w-3 [&>svg]:h-3 [&>svg]:w-3"></span>
                  </th:block>
                  <th:block th:if="${tagIcon == null or tagIcon.isEmpty()}">
                    <span>#</span>
                  </th:block>
                  <span th:text="${tag.spec.displayName}"></span>
                </a>
              </th:block>
            </div>

            <!-- 文章标题 -->
            <h1
              class="text-base-content mb-4 text-2xl leading-tight font-bold sm:text-3xl md:text-4xl"
              th:text="${post.spec.title}"
            >
              文章标题
            </h1>

            <!-- 元信息 - 使用 flex + gap -->
            <div class="text-base-content/60 flex flex-wrap items-center gap-x-4 gap-y-2 pb-6 text-sm">
              <!-- 作者 - 使用 avatar -->
              <div class="flex items-center gap-2" th:if="${post.owner != null}">
                <a
                  th:href="@{/authors/{name}(name=${post.owner.name})}"
                  class="group flex cursor-pointer items-center gap-2"
                  th:title="${post.owner.displayName}"
                >
                  <div class="avatar" th:if="${post.owner.avatar != null}">
                    <div class="group-hover:ring-primary/50 w-6 rounded-full transition-all group-hover:ring-2">
                      <img th:src="${post.owner.avatar}" th:alt="${post.owner.displayName}" />
                    </div>
                  </div>
                  <span
                    th:text="${post.owner.displayName}"
                    class="text-base-content/80 group-hover:text-primary font-medium transition-colors"
                  ></span>
                </a>
              </div>

              <!-- 发布时间 -->
              <div class="flex items-center gap-1.5">
                <span class="icon-[heroicons--calendar-days] h-4 w-4"></span>
                <span th:text="${#dates.format(post.spec.publishTime,'yyyy-MM-dd')}"></span>
              </div>

              <!-- 阅读量 -->
              <div class="flex items-center gap-1.5">
                <span class="icon-[heroicons--eye] h-4 w-4"></span>
                <span th:text="${post.stats.visit ?: 0}"></span>
              </div>

              <!-- 字数 -->
              <div class="flex items-center gap-1.5">
                <span class="icon-[heroicons--document-text] h-4 w-4"></span>
                <span><span id="word-count">-</span> 字</span>
              </div>

              <!-- 阅读时间 -->
              <div class="flex items-center gap-1.5">
                <span class="icon-[heroicons--clock] h-4 w-4"></span>
                <span><span id="reading-time">-</span> 分钟</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>
</html>
