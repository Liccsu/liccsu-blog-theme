<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org">

<!-- ========================================== -->
<!--        è£…å¤‡é¡µé¢ä¸»ä½“å†…å®¹                     -->
<!-- ========================================== -->

<th:block th:replace="~{plugin:equipment:modules/style}"></th:block>

<main class="equipment-page relative" th:fragment="equipment-content">
  <div class="max-w-6xl mx-auto px-4 py-8">
    <div class="author-content author-content-item essayPage single"
         th:style="'background:url('+${theme.config.equipment_settings?.cover_url}+') left 28% / cover no-repeat'">
      <div class="card-content">
        <div class="author-content-item-tips" th:text="${theme.config.equipment_settings?.page_subtitle} ?: 'å¥½ç‰©'">å¥½ç‰©</div>
        <span class="author-content-item-title" th:text="${theme.config.equipment_settings?.page_title} ?: 'è£…å¤‡åˆ—è¡¨'">è£…å¤‡åˆ—è¡¨</span>
        <div class="content-bottom">
            <div class="tips" th:text="${theme.config.equipment_settings?.page_description} ?: 'è·Ÿæˆ‘ä¸€èµ·äº«å—ç§‘æŠ€å¸¦æ¥çš„ä¹è¶£'">è·Ÿæˆ‘ä¸€èµ·äº«å—ç§‘æŠ€å¸¦æ¥çš„ä¹è¶£</div>
        </div>
      </div>
    </div>

    <th:block th:if="${not #lists.isEmpty(groups)}">
      <!-- ç§‘æŠ€é£æ ¼ -->
      <div id="equipment" th:if="${theme.config.equipment_settings?.mode == 'tech'}" x-data="{tab: ''}">
        <!-- èƒ¶å›Štab -->
        <div class="inline-flex p-1 bg-base-200/50 backdrop-blur-sm rounded-xl border border-base-content/10 dark:bg-base-300/40 dark:border-base-content/10">
          <button @click="tab = ''"
            :class="tab == '' ? 'bg-base-100 shadow-md text-base-content dark:bg-base-100/95' : 'text-base-content/60 hover:text-base-content hover:bg-base-100/40'"
            class="inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200">
            å…¨éƒ¨</button>
          <button th:each="group : ${groups}"
                  th:data-group-name="${group.spec.displayName}"
                  @click="tab = $el.dataset.groupName"
                  :class="tab == $el.dataset.groupName ? 'bg-base-100 shadow-md text-base-content dark:bg-base-100/95' : 'text-base-content/60 hover:text-base-content over:bg-base-100/40'"
                  class="inline-flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200">
                  [[${group.spec.displayName}]] [[${group.status.equipmentCount}]]</button>
        </div>

        <!-- è£…å¤‡å†…å®¹åŒºåŸŸ -->
        <div class="equipment-item" 
            th:each="group : ${groups}"
            th:data-group-name="${group.spec.displayName}"
            x-show="tab == '' || tab == $el.dataset.groupName">
          <div class="equipment-item-description" x-show="tab !== ''">âœ¨æè¿°ï¼š[[${group.spec.description}]]</div>
          <div class="equipment-item-content" th:with="equipmentList = ${group.equipments}">
            <div class="equipment-item-content-item" th:each="equipment : ${equipmentList}">
              <div class="equipment-item-content-item-cover">
                  <img class="equipment-item-content-item-image"
                      th:alt="${equipment.spec.displayName}"
                      th:src="${equipment.spec.cover}">
              </div>
              <div class="equipment-item-content-item-info">
                <div class="equipment-item-content-item-name tooltip"
                    data-tip="ç‚¹å‡»å¯æŸ¥çœ‹è¯¦æƒ…"
                    th:href="${equipment.spec.url}">
                    <span>[[${equipment.spec.displayName}]]</span>
                </div>
                <div class="equipment-item-content-item-specification">[[${equipment.spec.specification}]]</div>
                <div class="equipment-item-content-item-description tooltip"
                    th:data-tip="${equipment.spec.description}">
                    <span>[[${equipment.spec.description}]]</span>
                  </div>
                <div class="equipment-item-content-item-toolbar">
                  <a class="equipment-item-content-item-link" th:href="${equipment.spec.url}" target="_blank">è¯¦æƒ…</a>
                </div>
              </div>
            </div>
            <!-- ç©ºè£…å¤‡çŠ¶æ€ -->
            <div th:if="${group.equipments.isEmpty()}"
                class="equipment-empty"
                x-show="tab !== ''">
              <div class="equipment-empty-icon">ğŸ’»</div>
              <p>æš‚æ— è£…å¤‡æ•°æ®</p>
            </div>
          </div>
        </div>
      </div>
      
      <div id="equipment" th:if="${theme.config.equipment_settings?.mode == 'simple'}">
        <th:block th:each="group : ${groups}">
          <div class="equipment-item">
            <h2 class="equipment-item-title">[[${group.spec.displayName}]]</h2>
            <div class="equipment-item-description">[[${group.spec.description}]]</div>
            <div class="equipment-item-content" th:with="equipmentList = ${group.equipments}">
              <div class="equipment-item-content-item" th:each="equipment : ${equipmentList}">
                <div class="equipment-item-content-item-cover">
                    <img class="equipment-item-content-item-image"
                         th:alt="${equipment.spec.displayName}"
                         th:src="${equipment.spec.cover}">
                </div>
                <div class="equipment-item-content-item-info">
                  <div class="equipment-item-content-item-name tooltip"
                    data-tip="ç‚¹å‡»å¯æŸ¥çœ‹è¯¦æƒ…"
                    th:href="${equipment.spec.url}">
                    <span>[[${equipment.spec.displayName}]]</span>
                  </div>
                  <div class="equipment-item-content-item-specification">
                    [[${equipment.spec.specification}]]
                  </div>
                  <div class="equipment-item-content-item-description tooltip"
                    th:data-tip="${equipment.spec.description}">
                    <span>[[${equipment.spec.description}]]</span>
                  </div>
                  <div class="equipment-item-content-item-toolbar">
                    <a class="equipment-item-content-item-link" th:href="${equipment.spec.url}" target="_blank">è¯¦æƒ…</a>
                  </div>
                </div>
              </div>
              <!-- ç©ºè£…å¤‡çŠ¶æ€ -->
              <div th:if="${group.equipments.isEmpty()}" class="equipment-empty">
                <div class="equipment-empty-icon">ğŸ’»</div>
                <p>æš‚æ— è£…å¤‡æ•°æ®</p>
              </div>
            </div>
          </div>
        </th:block>
      </div>
    </th:block>

    <!-- ç©ºåˆ†ç»„çŠ¶æ€ -->
    <div th:if="${#lists.isEmpty(groups) && groups != null}" class="groups-empty">
      <div class="groups-empty-icon">ğŸ“¦</div>
      <p>æš‚æ— åˆ†ç»„æ•°æ®</p>
    </div>

    <!-- æ’ä»¶æœªåŠ è½½æç¤º -->
    <div th:if="${groups == null}" class="equipment-error groups-empty">
      <div class="groups-empty-icon">âŒ</div>
      <p>è£…å¤‡æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ’ä»¶é…ç½®</p>
    </div>

    <!-- è¯„è®ºåŒº -->
    <th:block class="mt-12"
      th:if="${theme.config.equipment_settings?.enable_comment != false}">
      <div class="flex items-center gap-3 mb-5">
        <div
          class="w-8 h-8 rounded-xl bg-gradient-to-br from-primary/20 to-primary/10 flex items-center justify-center">
          <span class="icon-[mdi--comment-text-outline] w-4 h-4 text-primary"></span>
        </div>
        <h2 class="text-lg font-semibold text-base-content">è¯„è®ºç•™è¨€</h2>
      </div>
      <div class="glow-card bg-base-100/80 backdrop-blur-xl rounded-2xl border border-base-content/[0.06] p-6">
        <halo:comment group="equipment.kunkunyu.com" kind="EquipmentPage" 
          th:name="${equipmentName}" colorScheme="system">
        </halo:comment>
      </div>
    </th:block>
  </div>

</main>

</html>

