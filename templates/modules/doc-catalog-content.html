<!-- 文档目录页 - 适配 Doc Layout (Sidebar + Content) -->
<div th:fragment="content" class="doc-layout">
  <!-- 左侧文档树 - 复用 doc-content.html 的侧边栏结构 -->
  <aside class="doc-sidebar hidden lg:block">
    <div class="doc-sidebar-inner scrollbar-thin">
      <!-- 版本选择器 -->
      <th:block th:if="${versions != null and #lists.size(versions) > 1}">
        <div class="doc-version-selector">
          <button class="doc-version-btn" onclick="this.nextElementSibling.classList.toggle('show')" type="button">
            <span class="flex items-center gap-2">
              <span class="icon-[heroicons--tag] h-4 w-4"></span>
              <span th:text="${currentVersion.spec.slug}">版本</span>
            </span>
            <span class="icon-[heroicons--chevron-down] h-4 w-4"></span>
          </button>
          <div class="doc-version-dropdown">
            <a
              th:each="version : ${versions}"
              th:href="${version.status.permalink}"
              class="doc-version-item"
              th:classappend="${version.metadata.name == currentVersion.metadata.name} ? 'active' : ''"
            >
              <span th:text="${version.spec.slug}">版本名</span>
            </a>
          </div>
        </div>
      </th:block>

      <!-- 语言选择器 -->
      <th:block th:if="${languages != null and #lists.size(languages) > 1}">
        <div class="doc-version-selector">
          <button class="doc-version-btn" onclick="this.nextElementSibling.classList.toggle('show')" type="button">
            <span class="flex items-center gap-2">
              <span class="icon-[heroicons--language] h-4 w-4"></span>
              <span th:if="${currentLanguage != null}" th:text="${currentLanguage.label}">语言</span>
              <span th:unless="${currentLanguage != null}">语言</span>
            </span>
            <span class="icon-[heroicons--chevron-down] h-4 w-4"></span>
          </button>
          <div class="doc-version-dropdown">
            <a th:each="language : ${languages}" th:href="${language.link}" class="doc-version-item">
              <span th:text="${language.label}">语言名</span>
            </a>
          </div>
        </div>
      </th:block>

      <!-- 项目标题 -->
      <a th:href="${project.status.permalink}" class="doc-project-title">
        <span class="icon-[heroicons--book-open] text-primary h-5 w-5 shrink-0"></span>
        <span class="truncate" th:text="${project.spec.displayName}">文档项目</span>
      </a>

      <!-- 文档树导航 -->
      <ul class="doc-nav-tree">
        <!-- 复用 doc-content 中的 tree-item 片段 -->
        <th:block th:replace="~{modules/doc-content :: tree-item(docTrees=${docTrees})}" />
      </ul>
    </div>
  </aside>

  <!-- 主内容区 - 与 doc-content.html 完全一致 -->
  <main class="doc-main">
    <div class="doc-content-wrapper">
      <!-- 面包屑 - 与 doc-content.html 完全一致 -->
      <nav class="doc-breadcrumb" aria-label="面包屑导航">
        <a th:href="${project.status.permalink}" class="flex items-center gap-1">
          <span class="icon-[heroicons--home] h-4 w-4"></span>
          <span th:text="${project.spec.displayName}">首页</span>
        </a>
        <th:block th:each="crumb : ${crumbs}">
          <span class="icon-[heroicons--chevron-right] h-3 w-3 opacity-40"></span>
          <a th:href="${crumb.status.permalink}" th:text="${crumb.spec.title}">分类</a>
        </th:block>
      </nav>

      <!-- 目录标题 - 使用 doc-title 样式与内容页一致 -->
      <h1 class="doc-title" th:text="${docTree.spec.title}">目录名称</h1>

      <!-- 子项目列表 - Glassmorphism Cards -->
      <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
        <a
          th:each="node : ${sonNodes}"
          th:href="${node.status.permalink}"
          class="glow-card group bg-base-100/80 border-base-content/[0.06] hover:border-primary/20 relative cursor-pointer overflow-hidden rounded-2xl border p-6 shadow-sm backdrop-blur-xl transition-all duration-300 ease-out hover:-translate-y-1 hover:shadow-xl"
        >
          <div class="flex items-start gap-5">
            <!-- 图标容器 -->
            <div
              class="bg-base-content/[0.03] group-hover:bg-primary/10 border-base-content/[0.05] flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl border transition-colors duration-300"
            >
              <span
                th:if="${node.spec.type == 'TREE'}"
                class="icon-[heroicons--folder] text-base-content/70 group-hover:text-primary h-6 w-6 transition-colors"
              ></span>
              <span
                th:if="${node.spec.type == 'DOC'}"
                class="icon-[heroicons--document-text] text-base-content/70 group-hover:text-primary h-6 w-6 transition-colors"
              ></span>
            </div>

            <!-- 内容区域 -->
            <div class="min-w-0 flex-1 pt-0.5">
              <h3
                class="text-base-content group-hover:text-primary mb-2 truncate text-lg leading-snug font-semibold transition-colors"
                th:text="${node.spec.title}"
              >
                项目名称
              </h3>

              <!-- 描述: 仅使用 spec.description (安全) -->
              <p
                th:if="${node.spec.description != null && !node.spec.description.isEmpty()}"
                class="text-base-content/60 line-clamp-2 text-sm leading-relaxed"
                th:text="${node.spec.description}"
              >
                描述内容...
              </p>
            </div>

            <!-- 悬浮箭头 -->
            <div
              class="text-primary absolute top-1/2 right-5 -translate-x-2 -translate-y-1/2 opacity-0 transition-all duration-300 group-hover:translate-x-0 group-hover:opacity-100"
            >
              <span class="icon-[heroicons--arrow-right] h-5 w-5"></span>
            </div>
          </div>
        </a>
      </div>

      <!-- 空状态 -->
      <div
        th:if="${sonNodes == null || sonNodes.isEmpty()}"
        class="glow-card bg-base-100/60 border-base-content/[0.06] mt-8 rounded-2xl border p-16 text-center shadow-lg backdrop-blur-xl"
      >
        <div class="bg-base-content/5 mx-auto mb-6 flex h-20 w-20 items-center justify-center rounded-full">
          <span class="icon-[heroicons--folder-open] text-base-content/30 h-10 w-10"></span>
        </div>
        <p class="text-base-content/60 text-lg font-medium">Empty Catalog</p>
        <p class="text-base-content/40 mt-1 text-sm">There are no items in this folder yet.</p>
      </div>
    </div>
  </main>
</div>
