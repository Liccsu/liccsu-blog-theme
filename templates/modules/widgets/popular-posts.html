<!doctype html>
<html xmlns:th="https://www.thymeleaf.org">
  <!-- ========================================== -->
  <!--   热门文章组件 - 带描述和徽章的简约风格   -->
  <!-- ========================================== -->

  <div
    th:fragment="list"
    class="card bg-base-100/80 border-base-content/5 rounded-[1.5rem] border p-5 shadow-lg backdrop-blur-xl"
    th:with="cfg = ${theme.config.general.sidebar_settings},
           postCount = ${cfg?.popular_posts_count ?: 5},
           popularPosts = ${postFinder.list({page: 1, size: postCount, sort: {'stats.visit,desc'}})}"
  >
    <!-- 标题栏 -->
    <div class="mb-4 flex items-center gap-3">
      <div class="from-error/20 to-error/10 flex h-9 w-9 items-center justify-center rounded-xl bg-gradient-to-br">
        <span class="icon-[heroicons--fire] text-error h-5 w-5"></span>
      </div>
      <div>
        <span class="text-base-content font-bold">热门文章</span>
        <p class="text-base-content/40 mt-0.5 text-xs font-medium">Top Stories</p>
      </div>
    </div>

    <!-- 文章列表 -->
    <div class="space-y-4">
      <a
        th:each="post, iterStat : ${popularPosts.items}"
        th:href="@{${post.status.permalink}}"
        th:title="${post.spec.title}"
        class="group block cursor-pointer"
      >
        <!-- 标题行 with 徽章 -->
        <div class="flex items-start gap-2">
          <!-- TOP 徽章 - 仅前3名 -->
          <span
            th:if="${iterStat.index < 3}"
            class="shrink-0 rounded px-1.5 py-0.5 text-[10px] font-bold"
            th:classappend="${iterStat.index == 0} ? 'bg-gradient-to-r from-amber-400 to-orange-500 text-white' : 
                              (${iterStat.index == 1} ? 'bg-gradient-to-r from-slate-300 to-slate-400 text-white' : 
                              'bg-gradient-to-r from-amber-600 to-amber-700 text-white')"
            th:text="|TOP${iterStat.index + 1}|"
            >TOP1</span
          >

          <!-- 标题 -->
          <h4
            class="text-base-content group-hover:text-primary flex-1 truncate text-sm font-medium transition-colors"
            th:text="${post.spec.title}"
          >
            文章标题
          </h4>
        </div>

        <!-- 描述/摘要 - 单行省略 -->
        <p
          class="text-base-content/50 mt-1 truncate text-xs"
          th:if="${post.spec.excerpt != null and post.spec.excerpt.raw != null and !post.spec.excerpt.raw.isEmpty()}"
          th:text="${post.spec.excerpt.raw}"
        >
          文章摘要...
        </p>

        <!-- 元信息徽章 -->
        <div class="mt-2 flex items-center gap-2">
          <span
            class="bg-base-200/60 text-base-content/50 inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px]"
          >
            <span class="icon-[heroicons--eye] h-3 w-3"></span>
            <span th:text="${post.stats.visit ?: 0}">0</span>
          </span>
          <span
            class="bg-base-200/60 text-base-content/50 inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px]"
          >
            <span class="icon-[heroicons--heart] h-3 w-3"></span>
            <span th:text="${post.stats.upvote ?: 0}">0</span>
          </span>
          <span
            class="bg-base-200/60 text-base-content/50 inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px]"
          >
            <span class="icon-[heroicons--chat-bubble-left] h-3 w-3"></span>
            <span th:text="${post.stats.comment ?: 0}">0</span>
          </span>
        </div>
      </a>
    </div>
  </div>
</html>
