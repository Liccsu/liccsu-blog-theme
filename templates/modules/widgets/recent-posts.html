<!doctype html>
<html xmlns:th="https://www.thymeleaf.org">
  <!-- ========================================== -->
  <!--   最新文章组件 - 时间线卡片风格           -->
  <!-- ========================================== -->

  <div
    th:fragment="list"
    class="card bg-base-100/80 border-base-content/5 rounded-[1.5rem] border p-5 shadow-lg backdrop-blur-xl"
    th:with="cfg = ${theme.config.general.sidebar_settings},
           postCount = ${cfg?.recent_posts_count ?: 5},
           recentPosts = ${postFinder.list({page: 1, size: postCount, sort: {'spec.publishTime,desc'}})}"
  >
    <!-- 标题栏 -->
    <div class="mb-5 flex items-center gap-3">
      <div class="from-success/20 to-success/10 flex h-9 w-9 items-center justify-center rounded-xl bg-gradient-to-br">
        <span class="icon-[heroicons--clock] text-success h-5 w-5"></span>
      </div>
      <div>
        <span class="text-base-content font-bold">最新文章</span>
        <p class="text-base-content/40 mt-0.5 text-xs font-medium">Recent Posts</p>
      </div>
    </div>

    <!-- 文章列表 - 时间线风格 -->
    <div class="relative">
      <!-- 时间线 -->
      <div
        class="from-success/30 via-base-content/10 absolute top-2 bottom-2 left-[19px] w-px bg-gradient-to-b to-transparent"
      ></div>

      <div class="space-y-4">
        <a
          th:each="post, iterStat : ${recentPosts.items}"
          th:href="@{${post.status.permalink}}"
          th:title="${post.spec.title}"
          class="group relative flex cursor-pointer gap-4"
        >
          <!-- 时间节点 -->
          <div class="relative flex shrink-0 flex-col items-center">
            <!-- 节点圆点 -->
            <div
              class="z-10 flex h-10 w-10 flex-col items-center justify-center rounded-xl transition-all"
              th:classappend="${iterStat.index == 0} ? 'bg-success/10 ring-2 ring-success/30' : 'bg-base-200/80'"
            >
              <span class="text-base-content text-xs font-bold" th:text="${#dates.format(post.spec.publishTime,'dd')}"
                >01</span
              >
              <span
                class="text-base-content/50 -mt-0.5 text-[9px]"
                th:text="${#dates.format(post.spec.publishTime,'MMM')}"
                >Jan</span
              >
            </div>
          </div>

          <!-- 文章内容 -->
          <div class="min-w-0 flex-1 pb-1">
            <!-- 标题 -->
            <h4
              class="text-base-content group-hover:text-primary line-clamp-2 text-sm leading-snug font-medium transition-colors"
              th:text="${post.spec.title}"
            >
              文章标题
            </h4>

            <!-- 元信息 + 描述 -->
            <div class="text-base-content/40 mt-1.5 flex items-center gap-1.5 truncate text-[10px]">
              <span class="inline-flex shrink-0 items-center gap-1">
                <span class="icon-[heroicons--eye] h-3 w-3"></span>
                <span th:text="${post.stats.visit ?: 0}">0</span>
              </span>
              <span th:if="${post.categories != null and !post.categories.isEmpty()}" class="shrink-0">·</span>
              <span
                th:if="${post.categories != null and !post.categories.isEmpty()}"
                class="shrink-0"
                th:text="${post.categories[0].spec.displayName}"
                >分类</span
              >
              <span
                th:if="${post.spec.excerpt != null and post.spec.excerpt.raw != null and !post.spec.excerpt.raw.isEmpty()}"
                class="shrink-0"
                >·</span
              >
              <span
                class="truncate"
                th:if="${post.spec.excerpt != null and post.spec.excerpt.raw != null and !post.spec.excerpt.raw.isEmpty()}"
                th:text="${post.spec.excerpt.raw}"
                >摘要</span
              >
            </div>
          </div>

          <!-- 箭头 -->
          <span
            class="icon-[heroicons--chevron-right] text-base-content/20 group-hover:text-primary h-4 w-4 shrink-0 self-center transition-all group-hover:translate-x-0.5"
          ></span>
        </a>
      </div>
    </div>
  </div>
</html>
